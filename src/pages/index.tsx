import { NextPage } from 'next';
import Head from 'next/head';
import {
  Header,
  Hero,
  OurWork,
  FeaturedSection,
  CTABanner,
  GridSection,
  Footer,
} from '@atomic';
import {
  navItems,
  heroData,
  ourWorkData,
  featuredEventsData,
  museumsData,
  footerData,
  CTABannerProps,
} from '../utils/data';

import styles from '../styles/Home.module.scss';

import { IEvent, IMuseum } from '../types';
interface IHomeProps {
  events: IEvent[];
  museums: IMuseum[];
}

const Home: NextPage<IHomeProps> = ({ events = [], museums }) => {
  return (
    <div className={styles.container}>
      <Head>
        <title>National Museums Scotland - Home Page</title>
        <meta
          name='description'
          content='Generated by create next app'
        />
        <link
          rel='icon'
          href='/favicon.ico'
        />
      </Head>
      <Header navItems={navItems} />
      <Hero {...heroData} />
      <OurWork {...ourWorkData} />
      <FeaturedSection events={events} />
      <CTABanner {...CTABannerProps} />
      <GridSection museums={museums} />
      <Footer {...footerData} />
    </div>
  );
};

export const getServerSideProps = async () => {
  const fetchEvents = await fetch('http://localhost:3000/api/v1/events');
  const fetchMuseums = await fetch('http://localhost:3000/api/v1/museums');
  const events = await fetchEvents.json();
  const museums = await fetchMuseums.json();

  return {
    props: {
      events: events.data.events,
      museums: museums.data.museums,
    },
  };
};

export default Home;
